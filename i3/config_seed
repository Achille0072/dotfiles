# EXECUTE xmodmap TO SEE THE VIRTUAL NAMES OF THE SPECIAL KEYS

#VARIABLES

# Set Win button
set $mod Mod4

# Update current layout to show it on the bar
set $get_layout "bash ~/.config/i3/get_i3layout.sh"

set $gaps 8px

set $refresh_i3status killall -SIGUSR1 i3status

set $exec exec --no-startup-id

#SETTINGS

# Font for window titles. Will also be used by the bar unless a different font is used in the bar {} block below.
font pango:DejaVu Sans Mono 8
title_align center

#set gaps settings (smart_gaps just sets no gaps if a single window is opened
gaps inner $gaps
smart_gaps on
default_border pixel

# client.focused #4c7899 #285577 #ffffff #2e9ef4 #285577

#always make bluetooth window float
for_window [title="Bluetooth Devices"] floating enable

# Use Mouse+$mod to drag floating windows to the wanted position
floating_modifier $mod

focus_follows_mouse no

#STARTUP

# Start XDG autostart .desktop files using dex. See also
# https://wiki.archlinux.org/index.php/XDG_Autostart
# $exec dex --autostart --environment i3


exec "xrandr --output eDP --scale 1.2 --mode 1920x1080"
$exec picom
$exec corectrl


# xss-lock grabs a logind suspend inhibit lock and will use i3lock to lock the screen before suspend. Use loginctl lock-session to lock your screen.
$exec xss-lock --transfer-sleep-lock -- i3lock --nofork
#prevent screen from going black on inactivity
$exec xset -dpms s off

# Low Battery Popup
$exec i3-battery-popup -n -D -L 20 -l 10

# Network manager and its applet to use the GUI from the bar
$exec systemctrl start NetworkManager
$exec nm-applet

# Bluetooth
#$exec blueman-applet

# Desktop Wallpaper
$exec nitrogen --restore

# Notification Manager
$exec_always --no-startup-id dunst -conf ~/.config/dunst/dunstrc

$exec_always --no-startup-id $get_layout
$exec "bash ~/.config/i3/Enable_languageswitch.sh"

# Enable tap to click (touchpad) 
$exec "bash ~/.config/i3/enable_touchpad.sh"

# Volume at 0% on startup
$exec pactl set-sink-volume @DEFAULT_SINK@ 0% && $refresh_i3status
$exec wpctl set-sink-volume @DEFAULT_SINK@ 0% && $refresh_i3status

# Start the browser on startup
$exec zen-browser

# Start Discord on startup
$exec vesktop

# start searxng container
$exec ~/.config/searxng/run.sh


#BINDINGS

@include "common_keys"
@include "normal_config"

# Define names for default workspaces for which we configure key bindings later on.
# We use variables to avoid repeating the names in multiple places.
workspace_layout default

set $ws1 "1"
set $ws2 "2"
set $ws3 "3"
set $ws4 "4"
set $ws5 "5"
set $ws6 "6"
set $ws7 "7"
set $ws8 "8"
set $ws9 "9"

bindsym $mod+r mode "resize"; $exec $get_layout

# resize window (you can also use the mouse for that)
mode "resize" {
        # These bindings trigger as soon as you enter the resize mode

        # Pressing left will shrink the window's width.
        # Pressing right will grow the window's width.
        # Pressing up will shrink the window's height.
        # Pressing down will grow the window's height.
        bindsym h resize shrink width 10 px or 10 ppt
        bindsym j resize grow height 10 px or 10 ppt
        bindsym k resize shrink height 10 px or 10 ppt
        bindsym l resize grow width 10 px or 10 ppt

        # same bindings, but for the arrow keys
        bindsym Left resize shrink width 10 px or 10 ppt
        bindsym Down resize grow height 10 px or 10 ppt
        bindsym Up resize shrink height 10 px or 10 ppt
        bindsym Right resize grow width 10 px or 10 ppt

        # back to normal
        bindsym Return mode "default"; $exec $get_layout
        bindsym Escape mode "default"; $exec $get_layout
}


mode "[VIM]" {

@include "common_keys"
@include "normal_config"

        bindsym Return exec i3-sensible-terminal

        bindsym 0 mode "Mouse"
# switch to workspace
        bindsym 1 workspace number $ws1; $exec $get_layout
        bindsym 2 workspace number $ws2; $exec $get_layout
        bindsym 3 workspace number $ws3; $exec $get_layout
        bindsym 4 workspace number $ws4; $exec $get_layout
        bindsym 5 workspace number $ws5; $exec $get_layout
        bindsym 6 workspace number $ws6; $exec $get_layout
        bindsym 7 workspace number $ws7; $exec $get_layout
        bindsym 8 workspace number $ws8; $exec $get_layout
        bindsym 9 workspace number $ws9; $exec $get_layout

        bindsym a exec "rofi -show window -theme ~/.config/rofi/custom_win.rasi"; $exec $get_layout
# split in horizontal orientation
        bindsym b split h; $exec $get_layout
        bindsym c exec "gnome-calculator"
# open menu
        bindsym d exec "rofi -modi drun,run -show drun"; $exec $get_layout
        bindsym e layout toggle split; $exec $get_layout   
        bindsym f exec firefox; $exec $get_layout
        bindsym g gaps inner all set 0
# change focus
        bindsym h focus left; $exec $get_layout
        bindsym i mode "[VIM] Insert"
# change focus
        bindsym j focus down; $exec $get_layout
# change focus
        bindsym k focus up; $exec $get_layout
# change focus
        bindsym l focus right; $exec $get_layout
        bindsym m mode "[VIM] Move"; $exec $get_layout
        bindsym n exec thunar; $exec $get_layout
        bindsym o gaps inner all set $gaps
# Take a screenshot
        bindsym p exec "flameshot gui"; $exec $get_layout
# kill focused window
        bindsym q kill; $exec $get_layout
        bindsym r mode "[VIM] Resize"; $exec $get_layout
# change container layout
        bindsym s layout stacking; $exec $get_layout
        bindsym t exec mousepad; $exec $get_layout
        bindsym u $exec "brightnessctl set 100%"
# split in vertical orientation
        bindsym v split v; $exec $get_layout
        bindsym w layout tabbed; $exec $get_layout
        bindsym x exec "dunstctl close-all"
#       bindsym y
# show last closed notification
        bindsym z exec "dunstctl history-pop"

        bindsym $mod+mod1+d mode "default"
}

mode "[VIM] Resize" {
        bindsym h resize shrink width 10 px or 10 ppt
        bindsym j resize grow height 10 px or 10 ppt
        bindsym k resize shrink height 10 px or 10 ppt
        bindsym l resize grow width 10 px or 10 ppt

        bindsym Escape mode "[VIM]"
        bindsym Return mode "[VIM]"
}

mode "[VIM] Insert" {

    bindsym Escape mode "[VIM]"

@include "common_keys"
@include "normal_config"

}

mode "[VIM] Move" {

        bindsym k move up
        bindsym j move down
        bindsym l move right
        bindsym h move left

        bindsym Shift+l move workspace to output right
        bindsym Shift+h move workspace to output left

        bindsym b split h; $exec $get_layout
        bindsym v split v; $exec $get_layout

        bindsym r mode "[VIM] Resize"

        bindsym 1 move container to workspace number $ws1; $exec $get_layout
        bindsym 2 move container to workspace number $ws2; $exec $get_layout
        bindsym 3 move container to workspace number $ws3; $exec $get_layout
        bindsym 4 move container to workspace number $ws4; $exec $get_layout
        bindsym 5 move container to workspace number $ws5; $exec $get_layout
        bindsym 6 move container to workspace number $ws6; $exec $get_layout
        bindsym 7 move container to workspace number $ws7; $exec $get_layout
        bindsym 8 move container to workspace number $ws8; $exec $get_layout
        bindsym 9 move container to workspace number $ws9; $exec $get_layout

        bindsym F1 move container to workspace number $ws1; workspace number $ws1; $exec $get_layout
        bindsym F2 move container to workspace number $ws2; workspace number $ws2; $exec $get_layout
        bindsym F3 move container to workspace number $ws3; workspace number $ws3; $exec $get_layout
        bindsym F4 move container to workspace number $ws4; workspace number $ws4; $exec $get_layout
        bindsym F5 move container to workspace number $ws5; workspace number $ws5; $exec $get_layout
        bindsym F6 move container to workspace number $ws6; workspace number $ws6; $exec $get_layout
        bindsym F7 move container to workspace number $ws7; workspace number $ws7; $exec $get_layout
        bindsym F8 move container to workspace number $ws8; workspace number $ws8; $exec $get_layout
        bindsym F9 move container to workspace number $ws9; workspace number $ws9; $exec $get_layout

        bindsym Escape mode "[VIM]"; $exec $get_layout
        bindsym Return mode "[VIM]"; $exec $get_layout

}

mode "Mouse" {

	set $quick 10
	set $fast 50

	# Mouse movement (quick)

	bindsym Left $exec xdotool mousemove_relative -- -$quick 0
	bindsym Down $exec xdotool mousemove_relative 0 $quick
	bindsym Up $exec xdotool mousemove_relative -- 0 -$quick
	bindsym Right $exec xdotool mousemove_relative $quick 0

	# Mouse movement (fast)

	bindsym Shift+Left $exec xdotool mousemove_relative -- -$fast 0
	bindsym Shift+Down $exec xdotool mousemove_relative 0 $fast
	bindsym Shift+Up $exec xdotool mousemove_relative -- 0 -$fast
	bindsym Shift+Right $exec xdotool mousemove_relative $fast 0

	# Left Click
	bindsym Return $exec xdotool click 1

	# Right Click
	bindsym BackSpace $exec xdotool click 3

	# Left Click-and-drag
	bindsym Shift+Return $exec xdotool mousedown 1 -$quick

	# Right Click-and-drag
	bindsym Shift+BackSpace $exec xdotool mousedown 3 -$quick

	# Left Drag release
	bindsym $mod+Return $exec xdotool mouseup 1

	# Right Drag release
	bindsym $mod+BackSpace $exec xdotool mouseup 3


	# return to normal keybindings

	bindsym Escape mode "[VIM]"
}



# Start i3bar to display a workspace bar (plus the system information i3status finds out, if available)
bar {
	position top
    status_command i3status    
#   status_command i3blocks
#   output primary
#   tray_output primary
}
